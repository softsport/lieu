{"version":3,"file":"lieu.es.min.js","sources":["../src/core/Helpers.js","../src/core/index.js","../src/core/const.js"],"sourcesContent":["class Helpers {\n    // Checks if passed object is object or not\n    static isObject(obj) {\n        return typeof obj === 'object';\n    }\n\n    // Checks if passed object is funcion or not\n    static isFunction(obj) {\n        return typeof obj === 'function';\n    }\n\n    /** Returns parsed from JSON object or null\n    @param obj<JSON>\n    */\n    static fromJson(obj) {\n        try {\n            const languagesFromJson = JSON.parse(obj);\n\n            if (this.isObject(languagesFromJson)) {\n                return languagesFromJson;\n            } else {\n                return null;\n            }\n        } catch {\n            return null;\n        }\n    }\n}\n\nexport default Helpers;\n","import Helpers from './Helpers';\nimport { STORAGE_KEY, ATTRIBUTE_NAME } from './const';\n\n/**\n * @param initialData<Object>\n */\nexport default class Lieu {\n    #isDebug = false; // boolean\n    #isPluginInitialized = false; // boolean\n    #initialData = null; // object\n    #languages = null; // object\n    #currentLanguage = null; // object\n    #initialLanguage = null; // string\n    #attributeName = ATTRIBUTE_NAME; // string\n\n    #onSetLang = (newLang, oldLang) => {};\n    #onGetLang = () => {};\n\n    constructor(initialData) {\n        this.#initialData = initialData;\n\n        this.#isDebug = initialData.isDebug;\n\n        this.#initLieu();\n    }\n\n    // Class initialization\n    #initLieu() {\n        this.#initLanguages();\n        this.#setHooks();\n        this.#setAttributeName();\n        this.#setInitialLanguage();\n    }\n\n    // Set class field languages if languages from inittial data is object or json\n    #initLanguages() {\n        let initialLanguages = this.#initialData?.languages;\n\n        if (Helpers.isObject(initialLanguages)) {\n            this.#setLanguages(initialLanguages);\n        } else {\n            initialLanguages = Helpers.fromJson(initialLanguages); // return null if lang not in json\n\n            this.#setLanguages(initialLanguages);\n        }\n    }\n\n    // Set hooks if they exist in inital data\n    #setHooks() {\n        if (Helpers.isFunction(this.#initialData.onSetLang)) {\n            this.#onSetLang = this.#initialData.onSetLang;\n        }\n\n        if (Helpers.isFunction(this.#initialData.onGetLang)) {\n            this.#onGetLang = this.#initialData.onGetLang;\n        }\n    }\n\n    // Set custom data attribute\n    #setAttributeName() {\n        const attr = this.#initialData?.attributeName;\n\n        if (attr) {\n            this.#attributeName = attr;\n        }\n    }\n\n    /** Set languages from initial data in languages class field\n    @param langs<Object>\n    */\n    #setLanguages(langs) {\n        this.#languages = langs;\n    }\n\n    // Set initial language from languages\n    #setInitialLanguage() {\n        const storageLangKey = window.localStorage?.getItem(STORAGE_KEY);\n        const langKeys = Object.keys(this.#languages);\n        const initialLangName = this.#initialData.initialLanguage;\n\n        let defaultLangKey;\n\n        if (storageLangKey) {\n            const isExistsInLangs = langKeys.find(\n                (key) => key === storageLangKey\n            );\n\n            // If it exists in languages set as initial\n            if (isExistsInLangs) {\n                defaultLangKey = this.#languages[storageLangKey];\n            }\n        }\n\n        if (initialLangName && !defaultLangKey) {\n            const isExistsInLangs = langKeys.find(\n                (key) => key === initialLangName\n            );\n\n            // If it exists in languages set as initial\n            if (isExistsInLangs) {\n                defaultLangKey = initialLangName;\n            }\n        } else {\n            defaultLangKey = langKeys[0];\n        }\n\n        this.#initialLanguage = defaultLangKey;\n\n        this.setLang(defaultLangKey);\n    }\n\n    /** Set new lang by string key from languages class field\n    @param langKey<String>\n    */\n    setLang(langKey) {\n        const newLanguage = this.#languages[langKey];\n        const oldLanguage = this.#currentLanguage;\n\n        if (!newLanguage) {\n            if (this.#isDebug) {\n                console.error(\n                    `Lieu | Language key \"${langKey}\" not found in languages!`\n                );\n            }\n\n            return;\n        }\n\n        this.#currentLanguage = newLanguage;\n        window.localStorage?.setItem(STORAGE_KEY, langKey);\n\n        this.#localizeDomElems();\n\n        if (this.#isPluginInitialized) {\n            this.#onSetLang(oldLanguage, newLanguage);\n        } else {\n            this.#isPluginInitialized = true;\n        }\n    }\n\n    // Find all data-attributes by attributeName field in DOM, and localize them\n    #localizeDomElems() {\n        const localeElems = Array.from(\n            document.querySelectorAll(`[${this.#attributeName}]`)\n        );\n\n        const { locales } = this.#currentLanguage;\n\n        localeElems.forEach((elem) => {\n            const locale = elem.getAttribute(this.#attributeName);\n\n            let localeText = locales[locale];\n\n            // If not found set attr value as text\n            if (!localeText) {\n                localeText = locale;\n\n                if (this.#isDebug) {\n                    console.warn(\n                        `Lieu | ${\n                            this.#attributeName\n                        } attribute value \"${locale}\" not found in current language!`\n                    );\n                }\n            }\n\n            elem.innerHTML = localeText;\n        });\n    }\n\n    /** Return value from currentLanguage.locales or null\n    @param localeKey<String>\n    */\n    localize(localeKey) {\n        const { locales } = this.#currentLanguage;\n        let locale = locales[localeKey];\n\n        if (!locale) {\n            locale = localeKey;\n\n            if (this.#isDebug) {\n                console.error(\n                    `Lieu | Locale key \"${localeKey}\" not found in current language!`\n                );\n            }\n        }\n\n        return locale;\n    }\n\n    /** Return value from currentLanguage.locales or null\n    @param localeKey<String>\n    */\n    __(localeKey) {\n        return this.localize(localeKey);\n    }\n\n    // Return browser language\n    getBrowserLang() {\n        return navigator?.language;\n    }\n\n    /** Return language object from languages class field by its' key\n    * or current langauge if @param langKey is not set\n    @param langKey<String> not required\n    */\n    getLang(langKey) {\n        this.#onGetLang();\n\n        if (langKey) {\n            return this.#languages[langKey];\n        }\n\n        return this.#currentLanguage;\n    }\n\n    // Returns object of all languages\n    getLangs() {\n        return this.#languages;\n    }\n\n    // Returns string of initial language\n    getInitialLang() {\n        return this.#initialLanguage;\n    }\n}\n","const STORAGE_KEY = 'lieu';\nconst ATTRIBUTE_NAME = 'data-lieu';\n\nexport { STORAGE_KEY, ATTRIBUTE_NAME };\n"],"names":["Helpers","static","obj","languagesFromJson","JSON","parse","this","isObject","Lieu","isDebug","isPluginInitialized","initialData","languages","currentLanguage","initialLanguage","attributeName","onSetLang","newLang","oldLang","onGetLang","constructor","initLieu","initLanguages","setHooks","setAttributeName","setInitialLanguage","initialLanguages","fromJson","setLanguages","isFunction","attr","langs","storageLangKey","window","localStorage","getItem","langKeys","Object","keys","initialLangName","defaultLangKey","find","key","setLang","langKey","newLanguage","oldLanguage","setItem","localizeDomElems","console","error","localeElems","Array","from","document","querySelectorAll","locales","forEach","elem","locale","getAttribute","localeText","warn","innerHTML","localize","localeKey","__","getBrowserLang","navigator","language","getLang","getLangs","getInitialLang"],"mappings":"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"}